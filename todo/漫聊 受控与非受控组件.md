# 漫谈 受控与非受控组件

>  在大多数情况下，我们推荐使用 [受控组件](https://zh-hans.reactjs.org/docs/forms.html#controlled-components) 来处理表单数据。在一个受控组件中，表单数据是由 React 组件来管理的。另一种替代方案是使用非受控组件，这时表单数据将交由 DOM 节点来处理。

以上是 React 官网对受控组件与非受控组件的一次解释，作为一个刚离开大学就开始使用 Vue  做 pc 端的前端玩家，在当时看到居然会直接使用由 DOM 节点直接开发的的非受控组件，实在很难以理解 React 这样的设置。因为在 vue 中，绝大部分的数据是绝对受控的。因为在开发 pc 端网站总是需要即时验证(即时给予用户交互，不让用户在填写完整的数据后再提示错误以致于过分沮丧)，

不过现在来看，非受控组件的确是 React 非常好的设计。

## 非受控与受控组件的区别

**非受控的输入**就像传统的HTML表单输入一样：

```jsx
class Form extends Component {
  /** 提交时候获取数据 */  
  handleSubmitClick = () => {
    const name = this._name.value;
    // 检测数据提示然后
  }
  render() {
    return  (
      <div>
        <input type="text" ref={input => this._name = input} />
        <button onClick={this.handleSubmitClick}>Sign up</button>
      </div>
    );
  }
}
```

我们只有在触发其他事件，才可以获取 DOM 数据中的值。

**受控的输入**接受当前的值作为参数，并且在值发生改变的时候执行回调函数。

```jsx
class NameForm extends React.Component {
  constructor(props) {
    super(props);
    this.state = {value: ''};

    this.handleChange = this.handleChange.bind(this);
    this.handleSubmit = this.handleSubmit.bind(this);
  }

  handleChange(event) {
    this.setState({value: event.target.value});
  }

  handleSubmit(event) {
    alert('提交的名字: ' + this.state.value);
    event.preventDefault();
  }

  render() {
    return (
      <form onSubmit={this.handleSubmit}>
        <label>
          名字:
          <input type="text" value={this.state.value} onChange={this.handleChange} />
        </label>
        <input type="submit" value="提交" />
      </form>
    );
  }
}
```

当用户一旦进行了数据的修改，程序立刻就可以知道哪些状态发生了改变，这时候我们就可以基于状态修改来构建更好的表单交互与用户体验。

受控与非受控组件可以类比比服务器和客户端的 push 和 pull 模型，push 是服务器主动发送数据给客户端，一旦有“数据改变”就立即推送，所以用户可以基于最新的消息做处理，而 pull 模型没法知道数据的细节变化，即使遇到了错误输出也只能最后检查通知用户。

除非你的表单中仅仅只需要提交时候验证，并且没有级联数据，强制格式输入等复杂用户交互，否则使用非受控组件就不太合适了。

## 为什么要使用非受控组件

如果不是因为没钱，谁会出来打工呢？如果没有受限的资源，大概就不需要非受控这一种说法了。

###  受限的时间考验

当我们在开发一个新的

### 受限的性能考验



### 受限的请求考验

其实这个例子已经不属于组件层面了

如果我们公司很有钱

如何理解受控与非受控呢？



## 参考资料

[controlled-vs-uncontrolled-inputs-react](https://goshakkk.name/controlled-vs-uncontrolled-inputs-react/)